# camp-bot
Представляю вам образовательный бот, бот был создал в 2019 году, мой второй бот в жизни :). 
Данный бот был обезличен так как он создавался на заказ в коммерческих целях
на безвозмездной основе, поэтому он тут.

Принцип работы бота.

Меню пользователя:

1 - Пользователь заходит в бота и нажимает start, идет проверка существует id пользователя в бд или нет, 
если нет, то предлагает зарегистироваться.

2 - Пользователь регистирурется, указывая свои данные, после регистрации необходимо активировать учетную запись, 
отправив id администратору который прислал бот.

3 - После активации учетной записи, пользователю приходит уведомление.

4 - Теперь у пользователя есть возможность, получать информацию о образовании, 
после отправки команды /Факультеты пользователю предлагается выбрать тип образование, например магистратура, далее предлагается выбрать факультет, 
далее выбираем направление и получаем итоговый запрос в таблицу prefix_table_data_bot и получаем информацию, преимущества, сроки обучения и тд.
В любом выборе образования пользователь может нажать кнопку назад (для этого использую State ) и изменить свой выбор, 
либо после получения итоговой информации может закончить работу или перейти в главное меню,  нажав опредленную кнопку.

Меню администратора: 

Администратор это пользователь у которого в таблице prefix_table_clients_bot в поле Admin установлено значение 1.

Меню администратор можно вызвать отправив боту команду /Admin.

1 - команда активировать учетную запись, после выбора команды активировать повяляется запрос id учетной записи, 
далее номер отдела, после получение данной информации идет запрос в таблицу на существование записи о данном пользователе, 
если ее нет, то администратору приходит уведомление, если учетная запись есть,
то меняется флаг is_active на 1 далее приходит сообщение администратору и пользователю. 

2 - команда /деактивировать еще не реализованна, но цель следующая, после запроса user_id перевод флага is_active в положение 0.


Что бы запустить бот необходимо установить все зависимости из requirements.txt.
Переименовать файл config_sample.py в config.py.
В файле config.py в поле API_TOKEN указать токен телеграмма.
В поле name_bot - указать имя вашего бота. 
В словаре param_sql - указать параметры для подключения к MS SQL.
В папке sql_tables содержатся sql скрипты для создания таблиц.
Везде "prefix_table" заменить на свое имя.
Описание таблиц:
prefix_table_clients_bot - содержит информацию о зарегистрировавшихся пользователей.
Если в поле is_active установить 1, то учетная запись активирована, если в поле Admin установить 1, 
то учетная запись может войти в административное меню.
prefix_table_data_bot - данная таблица содержит итоговую информацию по составленному запросу пользователя,
что за образование он получит, сколько учится, преимущества и тд.
prefix_table_Directions_bot - справочник направлений по типу образования и по факультету.
prefix_table_Faculties_bot - справочник факультетов по типу образования.
prefix_table_type_of_traning_bot - справочник типов образования.
prefix_table_mobile_units_log_bot - логирование для дальнейшей аналитики.



